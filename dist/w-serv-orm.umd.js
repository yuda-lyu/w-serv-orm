/*!
 * w-serv-orm v1.0.4
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("fs")):"function"==typeof define&&define.amd?define(["fs"],r):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-serv-orm"]=r(t.fs)}(this,(function(t){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=r(t);function n(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function o(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function i(t){return function(){var r=this,e=arguments;return new Promise((function(n,i){var a=t.apply(r,e);function u(t){o(a,n,i,u,c,"next",t)}function c(t){o(a,n,i,u,c,"throw",t)}u(void 0)}))}}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}var u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(t){var r={exports:{}};return t(r,r.exports),r.exports}var s=c((function(t){var r=function(t){var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function f(t,r,e,n){var o=r&&r.prototype instanceof b?r:b,i=Object.create(o.prototype),a=new P(n||[]);return i._invoke=function(t,r,e){var n=h;return function(o,i){if(n===p)throw new Error("Generator is already running");if(n===d){if("throw"===o)throw i;return D()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var u=S(a,e);if(u){if(u===y)continue;return u}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===h)throw n=d,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=p;var c=l(t,r,e);if("normal"===c.type){if(n=e.done?d:v,c.arg===y)continue;return{value:c.arg,done:e.done}}"throw"===c.type&&(n=d,e.method="throw",e.arg=c.arg)}}}(t,e,a),i}function l(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var h="suspendedStart",v="suspendedYield",p="executing",d="completed",y={};function b(){}function g(){}function m(){}var j={};s(j,i,(function(){return this}));var w=Object.getPrototypeOf,_=w&&w(w(M([])));_&&_!==e&&n.call(_,i)&&(j=_);var x=m.prototype=b.prototype=Object.create(j);function O(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function $(t,r){function e(o,i,u,c){var s=l(t[o],t,i);if("throw"!==s.type){var f=s.arg,h=f.value;return h&&"object"===a(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,u,c)}),(function(t){e("throw",t,u,c)})):r.resolve(h).then((function(t){f.value=t,u(f)}),(function(t){return e("throw",t,u,c)}))}c(s.arg)}var o;this._invoke=function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,S(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function k(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function A(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function M(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:D}}function D(){return{value:r,done:!0}}return g.prototype=m,s(x,"constructor",m),s(m,"constructor",g),g.displayName=s(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===g||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},O($.prototype),s($.prototype,u,(function(){return this})),t.AsyncIterator=$,t.async=function(r,e,n,o,i){void 0===i&&(i=Promise);var a=new $(f(r,e,n,o),i);return t.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(x),s(x,c,"Generator"),s(x,i,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=M,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return u.type="throw",u.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),A(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;A(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:M(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),y}},t}(t.exports);try{regeneratorRuntime=r}catch(t){"object"===("undefined"==typeof globalThis?"undefined":a(globalThis))?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}})),f=s,l="object"==a(u)&&u&&u.Object===Object&&u,h="object"==("undefined"==typeof self?"undefined":a(self))&&self&&self.Object===Object&&self,v=l||h||Function("return this")(),p=v.Symbol;var d=function(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o},y=Array.isArray,b=Object.prototype,g=b.hasOwnProperty,m=b.toString,j=p?p.toStringTag:void 0;var w=function(t){var r=g.call(t,j),e=t[j];try{t[j]=void 0;var n=!0}catch(t){}var o=m.call(t);return n&&(r?t[j]=e:delete t[j]),o},_=Object.prototype.toString;var x=function(t){return _.call(t)},O=p?p.toStringTag:void 0;var $=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":O&&O in Object(t)?w(t):x(t)};var S=function(t){return null!=t&&"object"==a(t)};var k=function(t){return"symbol"==a(t)||S(t)&&"[object Symbol]"==$(t)},A=p?p.prototype:void 0,P=A?A.toString:void 0;var M=function t(r){if("string"==typeof r)return r;if(y(r))return d(r,t)+"";if(k(r))return P?P.call(r):"";var e=r+"";return"0"==e&&1/r==-Infinity?"-0":e},D=/\s/;var E=function(t){for(var r=t.length;r--&&D.test(t.charAt(r)););return r},L=/^\s+/;var T=function(t){return t?t.slice(0,E(t)+1).replace(L,""):t};var I=function(t,r,e){var n=-1,o=t.length;r<0&&(r=-r>o?0:o+r),(e=e>o?o:e)<0&&(e+=o),o=r>e?0:e-r>>>0,r>>>=0;for(var i=Array(o);++n<o;)i[n]=t[n+r];return i};var z=function(t,r,e){var n=t.length;return e=void 0===e?n:e,!r&&e>=n?t:I(t,r,e)};var N=function(t,r,e,n){for(var o=t.length,i=e+(n?1:-1);n?i--:++i<o;)if(r(t[i],i,t))return i;return-1};var F=function(t){return t!=t};var C=function(t,r,e){for(var n=e-1,o=t.length;++n<o;)if(t[n]===r)return n;return-1};var U=function(t,r,e){return r==r?C(t,r,e):N(t,F,e)};var Y=function(t,r){for(var e=t.length;e--&&U(r,t[e],0)>-1;);return e};var W=function(t,r){for(var e=-1,n=t.length;++e<n&&U(r,t[e],0)>-1;);return e};var H=function(t){return t.split("")},B=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var R=function(t){return B.test(t)},G="\\ud800-\\udfff",V="["+G+"]",J="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Z="\\ud83c[\\udffb-\\udfff]",q="[^"+G+"]",Q="(?:\\ud83c[\\udde6-\\uddff]){2}",K="[\\ud800-\\udbff][\\udc00-\\udfff]",X="(?:"+J+"|"+Z+")"+"?",tt="[\\ufe0e\\ufe0f]?",rt=tt+X+("(?:\\u200d(?:"+[q,Q,K].join("|")+")"+tt+X+")*"),et="(?:"+[q+J+"?",J,Q,K,V].join("|")+")",nt=RegExp(Z+"(?="+Z+")|"+et+rt,"g");var ot=function(t){return t.match(nt)||[]};var it=function(t){return R(t)?ot(t):H(t)};var at=function(t){return null==t?"":M(t)};var ut=function(t,r,e){if((t=at(t))&&(e||void 0===r))return T(t);if(!t||!(r=M(r)))return t;var n=it(t),o=it(r),i=W(n,o),a=Y(n,o)+1;return z(n,i,a).join("")},ct=Object.prototype;var st=function(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||ct)};var ft=function(t,r){return function(e){return t(r(e))}}(Object.keys,Object),lt=Object.prototype.hasOwnProperty;var ht=function(t){if(!st(t))return ft(t);var r=[];for(var e in Object(t))lt.call(t,e)&&"constructor"!=e&&r.push(e);return r};var vt=function(t){var r=a(t);return null!=t&&("object"==r||"function"==r)};var pt,dt=function(t){if(!vt(t))return!1;var r=$(t);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r},yt=v["__core-js_shared__"],bt=(pt=/[^.]+$/.exec(yt&&yt.keys&&yt.keys.IE_PROTO||""))?"Symbol(src)_1."+pt:"";var gt=function(t){return!!bt&&bt in t},mt=Function.prototype.toString;var jt=function(t){if(null!=t){try{return mt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},wt=/^\[object .+?Constructor\]$/,_t=Function.prototype,xt=Object.prototype,Ot=_t.toString,$t=xt.hasOwnProperty,St=RegExp("^"+Ot.call($t).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var kt=function(t){return!(!vt(t)||gt(t))&&(dt(t)?St:wt).test(jt(t))};var At=function(t,r){return null==t?void 0:t[r]};var Pt=function(t,r){var e=At(t,r);return kt(e)?e:void 0},Mt=Pt(v,"DataView"),Dt=Pt(v,"Map"),Et=Pt(v,"Promise"),Lt=Pt(v,"Set"),Tt=Pt(v,"WeakMap"),It="[object Map]",zt="[object Promise]",Nt="[object Set]",Ft="[object WeakMap]",Ct="[object DataView]",Ut=jt(Mt),Yt=jt(Dt),Wt=jt(Et),Ht=jt(Lt),Bt=jt(Tt),Rt=$;(Mt&&Rt(new Mt(new ArrayBuffer(1)))!=Ct||Dt&&Rt(new Dt)!=It||Et&&Rt(Et.resolve())!=zt||Lt&&Rt(new Lt)!=Nt||Tt&&Rt(new Tt)!=Ft)&&(Rt=function(t){var r=$(t),e="[object Object]"==r?t.constructor:void 0,n=e?jt(e):"";if(n)switch(n){case Ut:return Ct;case Yt:return It;case Wt:return zt;case Ht:return Nt;case Bt:return Ft}return r});var Gt=Rt;var Vt=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var Jt=function(t){return null!=t&&Vt(t.length)&&!dt(t)};var Zt=function(t){return"string"==typeof t||!y(t)&&S(t)&&"[object String]"==$(t)};var qt=function(t){return function(r){return null==r?void 0:r[t]}},Qt=qt("length"),Kt="\\ud800-\\udfff",Xt="["+Kt+"]",tr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",rr="\\ud83c[\\udffb-\\udfff]",er="[^"+Kt+"]",nr="(?:\\ud83c[\\udde6-\\uddff]){2}",or="[\\ud800-\\udbff][\\udc00-\\udfff]",ir="(?:"+tr+"|"+rr+")"+"?",ar="[\\ufe0e\\ufe0f]?",ur=ar+ir+("(?:\\u200d(?:"+[er,nr,or].join("|")+")"+ar+ir+")*"),cr="(?:"+[er+tr+"?",tr,nr,or,Xt].join("|")+")",sr=RegExp(rr+"(?="+rr+")|"+cr+ur,"g");var fr=function(t){for(var r=sr.lastIndex=0;sr.test(t);)++r;return r};var lr=function(t){return R(t)?fr(t):Qt(t)};var hr=function(t){if(null==t)return 0;if(Jt(t))return Zt(t)?lr(t):t.length;var r=Gt(t);return"[object Map]"==r||"[object Set]"==r?t.size:ht(t).length},vr=/^[-+]0x[0-9a-f]+$/i,pr=/^0b[01]+$/i,dr=/^0o[0-7]+$/i,yr=parseInt;var br=function(t){if("number"==typeof t)return t;if(k(t))return NaN;if(vt(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=vt(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=T(t);var e=pr.test(t);return e||dr.test(t)?yr(t.slice(2),e?2:8):vr.test(t)?NaN:+t},gr=1/0;var mr=function(t){return t?(t=br(t))===gr||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var jr=function(t){var r=mr(t),e=r%1;return r==r?e?r-e:r:0};var wr=function(t,r,e){var n=null==t?0:t.length;return n?(r=e||void 0===r?1:jr(r),I(t,r<0?0:r,n)):[]};var _r=function(t,r){for(var e=-1,n=null==t?0:t.length;++e<n&&!1!==r(t[e],e,t););return t};var xr=function(t){return function(r,e,n){for(var o=-1,i=Object(r),a=n(r),u=a.length;u--;){var c=a[t?u:++o];if(!1===e(i[c],c,i))break}return r}}();var Or=function(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n};var $r=function(t){return S(t)&&"[object Arguments]"==$(t)},Sr=Object.prototype,kr=Sr.hasOwnProperty,Ar=Sr.propertyIsEnumerable,Pr=$r(function(){return arguments}())?$r:function(t){return S(t)&&kr.call(t,"callee")&&!Ar.call(t,"callee")},Mr=Pr;var Dr=function(){return!1},Er=c((function(t,r){var e=r&&!r.nodeType&&r,n=e&&t&&!t.nodeType&&t,o=n&&n.exports===e?v.Buffer:void 0,i=(o?o.isBuffer:void 0)||Dr;t.exports=i})),Lr=/^(?:0|[1-9]\d*)$/;var Tr=function(t,r){var e=a(t);return!!(r=null==r?9007199254740991:r)&&("number"==e||"symbol"!=e&&Lr.test(t))&&t>-1&&t%1==0&&t<r},Ir={};Ir["[object Float32Array]"]=Ir["[object Float64Array]"]=Ir["[object Int8Array]"]=Ir["[object Int16Array]"]=Ir["[object Int32Array]"]=Ir["[object Uint8Array]"]=Ir["[object Uint8ClampedArray]"]=Ir["[object Uint16Array]"]=Ir["[object Uint32Array]"]=!0,Ir["[object Arguments]"]=Ir["[object Array]"]=Ir["[object ArrayBuffer]"]=Ir["[object Boolean]"]=Ir["[object DataView]"]=Ir["[object Date]"]=Ir["[object Error]"]=Ir["[object Function]"]=Ir["[object Map]"]=Ir["[object Number]"]=Ir["[object Object]"]=Ir["[object RegExp]"]=Ir["[object Set]"]=Ir["[object String]"]=Ir["[object WeakMap]"]=!1;var zr=function(t){return S(t)&&Vt(t.length)&&!!Ir[$(t)]};var Nr=function(t){return function(r){return t(r)}},Fr=c((function(t,r){var e=r&&!r.nodeType&&r,n=e&&t&&!t.nodeType&&t,o=n&&n.exports===e&&l.process,i=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=i})),Cr=Fr&&Fr.isTypedArray,Ur=Cr?Nr(Cr):zr,Yr=Object.prototype.hasOwnProperty;var Wr=function(t,r){var e=y(t),n=!e&&Mr(t),o=!e&&!n&&Er(t),i=!e&&!n&&!o&&Ur(t),a=e||n||o||i,u=a?Or(t.length,String):[],c=u.length;for(var s in t)!r&&!Yr.call(t,s)||a&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Tr(s,c))||u.push(s);return u};var Hr=function(t){return Jt(t)?Wr(t):ht(t)};var Br=function(t,r){return function(e,n){if(null==e)return e;if(!Jt(e))return t(e,n);for(var o=e.length,i=r?o:-1,a=Object(e);(r?i--:++i<o)&&!1!==n(a[i],i,a););return e}}((function(t,r){return t&&xr(t,r,Hr)}));var Rr=function(t){return t};var Gr=function(t){return"function"==typeof t?t:Rr};var Vr=function(t,r){return(y(t)?_r:Br)(t,Gr(r))};function Jr(){var t,r,e=new Promise((function(){t=arguments[0],r=arguments[1]}));return e.resolve=t,e.reject=r,e}function Zr(t){return"[object Array]"===Object.prototype.toString.call(t)}function qr(t){return"[object Object]"===Object.prototype.toString.call(t)}function Qr(t){var r=Object.prototype.toString.call(t);return"[object Function]"===r||"[object AsyncFunction]"===r}function Kr(t,r){var e=Jr();if(!Zr(t)&&!qr(t))return e.reject("rs is not an array or object"),e;var n=!1;if(qr(t)){n=!0;var o=[];Vr(t,(function(t,r){o.push({k:r,v:t})})),t=o}Qr(r)||(r=function(t){return t});var i=-1,a=[];return t.reduce((function(t,e){return t.then((function(t){a.push(t);var o=i+=1,u=e;return n&&(o=e.k,u=e.v),Qr(r)?r(u,o):u}))}),Promise.resolve()).then((function(t){a.push(t),a=wr(a),e.resolve(a)})).catch((function(t){e.reject(t)})),e}function Xr(t){return!!e.default.existsSync(t)&&(!e.default.lstatSync(t).isDirectory()&&!e.default.lstatSync(t).isSymbolicLink())}function te(t){if(qr(t)){for(var r in t)return!0;return!1}return!1}var re=function(t){return!0===t||!1===t||S(t)&&"[object Boolean]"==$(t)};function ee(t){return re(t)}function ne(t){return!(!function(t){return"[object String]"===Object.prototype.toString.call(t)}(t)||""===t)}function oe(t){if(!ne(t))return{};var r={};try{r=JSON.parse(t)}catch(t){r={}}return r}function ie(){return ie=i(f.mark((function t(r){var e;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Kr(r,function(){var t=i(f.mark((function t(r,e){var n;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("backup...",e),t.next=3,r.select();case 3:return n=t.sent,t.abrupt("return",{name:e,data:n});case 5:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}());case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)}))),ie.apply(this,arguments)}function ae(){return ae=i(f.mark((function t(r,n,o){var a,u,c,s=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=s.length>3&&void 0!==s[3]&&s[3],Xr(r)){t.next=4;break}throw console.log("fp",r),new Error("fp is not exist");case 4:if(te(n)){t.next=7;break}throw console.log("woItems",n),new Error("invalid woItems");case 7:return Qr(o)||(o=null),ee(a)||(a=!1),u=e.default.readFileSync(r,"utf8"),u=ut(u),c=oe(u),Qr(o)&&o(),t.next=15,Kr(c,function(){var t=i(f.mark((function t(r){var e;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("recover...",r.name),!a){t.next=5;break}return console.log("needCreateStorage"),t.next=5,n[r.name].createStorage();case 5:if(e=null,!(hr(r.data)>0)){t.next=10;break}return t.next=9,n[r.name].insert(r.data);case 9:e=t.sent;case 10:return t.abrupt("return",e);case 11:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}());case 15:case"end":return t.stop()}}),t)}))),ae.apply(this,arguments)}var ue={backup:function(t){return ie.apply(this,arguments)},recover:function(t,r,e){return ae.apply(this,arguments)}};function ce(t,r,e,n){if(0===hr(t))throw console.log("ds",t),new Error("invalid ds");if(!Qr(r))throw console.log("WOrm",r),new Error("invalid WOrm");if(!ne(e))throw console.log("url",e),new Error("invalid url");if(!ne(n))throw console.log("db",n),new Error("invalid db");var o={};return Vr(Hr(t),(function(t){var i=new r({url:e,db:n,cl:t});o[t]=i})),o}function se(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function fe(t){return function(t){if(Array.isArray(t))return se(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return se(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?se(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var le=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,he=/^\w*$/;var ve=function(t,r){if(y(t))return!1;var e=a(t);return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!k(t))||(he.test(t)||!le.test(t)||null!=r&&t in Object(r))},pe=Pt(Object,"create");var de=function(){this.__data__=pe?pe(null):{},this.size=0};var ye=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},be=Object.prototype.hasOwnProperty;var ge=function(t){var r=this.__data__;if(pe){var e=r[t];return"__lodash_hash_undefined__"===e?void 0:e}return be.call(r,t)?r[t]:void 0},me=Object.prototype.hasOwnProperty;var je=function(t){var r=this.__data__;return pe?void 0!==r[t]:me.call(r,t)};var we=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=pe&&void 0===r?"__lodash_hash_undefined__":r,this};function _e(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}_e.prototype.clear=de,_e.prototype.delete=ye,_e.prototype.get=ge,_e.prototype.has=je,_e.prototype.set=we;var xe=_e;var Oe=function(){this.__data__=[],this.size=0};var $e=function(t,r){return t===r||t!=t&&r!=r};var Se=function(t,r){for(var e=t.length;e--;)if($e(t[e][0],r))return e;return-1},ke=Array.prototype.splice;var Ae=function(t){var r=this.__data__,e=Se(r,t);return!(e<0)&&(e==r.length-1?r.pop():ke.call(r,e,1),--this.size,!0)};var Pe=function(t){var r=this.__data__,e=Se(r,t);return e<0?void 0:r[e][1]};var Me=function(t){return Se(this.__data__,t)>-1};var De=function(t,r){var e=this.__data__,n=Se(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};function Ee(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Ee.prototype.clear=Oe,Ee.prototype.delete=Ae,Ee.prototype.get=Pe,Ee.prototype.has=Me,Ee.prototype.set=De;var Le=Ee;var Te=function(){this.size=0,this.__data__={hash:new xe,map:new(Dt||Le),string:new xe}};var Ie=function(t){var r=a(t);return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t};var ze=function(t,r){var e=t.__data__;return Ie(r)?e["string"==typeof r?"string":"hash"]:e.map};var Ne=function(t){var r=ze(this,t).delete(t);return this.size-=r?1:0,r};var Fe=function(t){return ze(this,t).get(t)};var Ce=function(t){return ze(this,t).has(t)};var Ue=function(t,r){var e=ze(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};function Ye(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Ye.prototype.clear=Te,Ye.prototype.delete=Ne,Ye.prototype.get=Fe,Ye.prototype.has=Ce,Ye.prototype.set=Ue;var We=Ye;function He(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var e=function e(){var n=arguments,o=r?r.apply(this,n):n[0],i=e.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return e.cache=i.set(o,a)||i,a};return e.cache=new(He.Cache||We),e}He.Cache=We;var Be=He;var Re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ge=/\\(\\)?/g,Ve=function(t){var r=Be(t,(function(t){return 500===e.size&&e.clear(),t})),e=r.cache;return r}((function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(Re,(function(t,e,n,o){r.push(n?o.replace(Ge,"$1"):e||t)})),r}));var Je=function(t,r){return y(t)?t:ve(t,r)?[t]:Ve(at(t))};var Ze=function(t){if("string"==typeof t||k(t))return t;var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r};var qe=function(t,r){for(var e=0,n=(r=Je(r,t)).length;null!=t&&e<n;)t=t[Ze(r[e++])];return e&&e==n?t:void 0};var Qe=function(t,r,e){var n=null==t?void 0:qe(t,r);return void 0===n?e:n};var Ke=function(){this.__data__=new Le,this.size=0};var Xe=function(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e};var tn=function(t){return this.__data__.get(t)};var rn=function(t){return this.__data__.has(t)};var en=function(t,r){var e=this.__data__;if(e instanceof Le){var n=e.__data__;if(!Dt||n.length<199)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new We(n)}return e.set(t,r),this.size=e.size,this};function nn(t){var r=this.__data__=new Le(t);this.size=r.size}nn.prototype.clear=Ke,nn.prototype.delete=Xe,nn.prototype.get=tn,nn.prototype.has=rn,nn.prototype.set=en;var on=nn;var an=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var un=function(t){return this.__data__.has(t)};function cn(t){var r=-1,e=null==t?0:t.length;for(this.__data__=new We;++r<e;)this.add(t[r])}cn.prototype.add=cn.prototype.push=an,cn.prototype.has=un;var sn=cn;var fn=function(t,r){for(var e=-1,n=null==t?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1};var ln=function(t,r){return t.has(r)};var hn=function(t,r,e,n,o,i){var a=1&e,u=t.length,c=r.length;if(u!=c&&!(a&&c>u))return!1;var s=i.get(t),f=i.get(r);if(s&&f)return s==r&&f==t;var l=-1,h=!0,v=2&e?new sn:void 0;for(i.set(t,r),i.set(r,t);++l<u;){var p=t[l],d=r[l];if(n)var y=a?n(d,p,l,r,t,i):n(p,d,l,t,r,i);if(void 0!==y){if(y)continue;h=!1;break}if(v){if(!fn(r,(function(t,r){if(!ln(v,r)&&(p===t||o(p,t,e,n,i)))return v.push(r)}))){h=!1;break}}else if(p!==d&&!o(p,d,e,n,i)){h=!1;break}}return i.delete(t),i.delete(r),h},vn=v.Uint8Array;var pn=function(t){var r=-1,e=Array(t.size);return t.forEach((function(t,n){e[++r]=[n,t]})),e};var dn=function(t){var r=-1,e=Array(t.size);return t.forEach((function(t){e[++r]=t})),e},yn=p?p.prototype:void 0,bn=yn?yn.valueOf:void 0;var gn=function(t,r,e,n,o,i,a){switch(e){case"[object DataView]":if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=r.byteLength||!i(new vn(t),new vn(r)));case"[object Boolean]":case"[object Date]":case"[object Number]":return $e(+t,+r);case"[object Error]":return t.name==r.name&&t.message==r.message;case"[object RegExp]":case"[object String]":return t==r+"";case"[object Map]":var u=pn;case"[object Set]":var c=1&n;if(u||(u=dn),t.size!=r.size&&!c)return!1;var s=a.get(t);if(s)return s==r;n|=2,a.set(t,r);var f=hn(u(t),u(r),n,o,i,a);return a.delete(t),f;case"[object Symbol]":if(bn)return bn.call(t)==bn.call(r)}return!1};var mn=function(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t};var jn=function(t,r,e){var n=r(t);return y(t)?n:mn(n,e(t))};var wn=function(t,r){for(var e=-1,n=null==t?0:t.length,o=0,i=[];++e<n;){var a=t[e];r(a,e,t)&&(i[o++]=a)}return i};var _n=function(){return[]},xn=Object.prototype.propertyIsEnumerable,On=Object.getOwnPropertySymbols,$n=On?function(t){return null==t?[]:(t=Object(t),wn(On(t),(function(r){return xn.call(t,r)})))}:_n;var Sn=function(t){return jn(t,Hr,$n)},kn=Object.prototype.hasOwnProperty;var An=function(t,r,e,n,o,i){var a=1&e,u=Sn(t),c=u.length;if(c!=Sn(r).length&&!a)return!1;for(var s=c;s--;){var f=u[s];if(!(a?f in r:kn.call(r,f)))return!1}var l=i.get(t),h=i.get(r);if(l&&h)return l==r&&h==t;var v=!0;i.set(t,r),i.set(r,t);for(var p=a;++s<c;){var d=t[f=u[s]],y=r[f];if(n)var b=a?n(y,d,f,r,t,i):n(d,y,f,t,r,i);if(!(void 0===b?d===y||o(d,y,e,n,i):b)){v=!1;break}p||(p="constructor"==f)}if(v&&!p){var g=t.constructor,m=r.constructor;g==m||!("constructor"in t)||!("constructor"in r)||"function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m||(v=!1)}return i.delete(t),i.delete(r),v},Pn="[object Arguments]",Mn="[object Array]",Dn="[object Object]",En=Object.prototype.hasOwnProperty;var Ln=function(t,r,e,n,o,i){var a=y(t),u=y(r),c=a?Mn:Gt(t),s=u?Mn:Gt(r),f=(c=c==Pn?Dn:c)==Dn,l=(s=s==Pn?Dn:s)==Dn,h=c==s;if(h&&Er(t)){if(!Er(r))return!1;a=!0,f=!1}if(h&&!f)return i||(i=new on),a||Ur(t)?hn(t,r,e,n,o,i):gn(t,r,c,e,n,o,i);if(!(1&e)){var v=f&&En.call(t,"__wrapped__"),p=l&&En.call(r,"__wrapped__");if(v||p){var d=v?t.value():t,b=p?r.value():r;return i||(i=new on),o(d,b,e,n,i)}}return!!h&&(i||(i=new on),An(t,r,e,n,o,i))};var Tn=function t(r,e,n,o,i){return r===e||(null==r||null==e||!S(r)&&!S(e)?r!=r&&e!=e:Ln(r,e,n,o,t,i))};var In=function(t,r,e,n){var o=e.length,i=o,a=!n;if(null==t)return!i;for(t=Object(t);o--;){var u=e[o];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<i;){var c=(u=e[o])[0],s=t[c],f=u[1];if(a&&u[2]){if(void 0===s&&!(c in t))return!1}else{var l=new on;if(n)var h=n(s,f,c,t,r,l);if(!(void 0===h?Tn(f,s,3,n,l):h))return!1}}return!0};var zn=function(t){return t==t&&!vt(t)};var Nn=function(t){for(var r=Hr(t),e=r.length;e--;){var n=r[e],o=t[n];r[e]=[n,o,zn(o)]}return r};var Fn=function(t,r){return function(e){return null!=e&&(e[t]===r&&(void 0!==r||t in Object(e)))}};var Cn=function(t){var r=Nn(t);return 1==r.length&&r[0][2]?Fn(r[0][0],r[0][1]):function(e){return e===t||In(e,t,r)}};var Un=function(t,r){return null!=t&&r in Object(t)};var Yn=function(t,r,e){for(var n=-1,o=(r=Je(r,t)).length,i=!1;++n<o;){var a=Ze(r[n]);if(!(i=null!=t&&e(t,a)))break;t=t[a]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&Vt(o)&&Tr(a,o)&&(y(t)||Mr(t))};var Wn=function(t,r){return null!=t&&Yn(t,r,Un)};var Hn=function(t,r){return ve(t)&&zn(r)?Fn(Ze(t),r):function(e){var n=Qe(e,t);return void 0===n&&n===r?Wn(e,t):Tn(r,n,3)}};var Bn=function(t){return function(r){return qe(r,t)}};var Rn=function(t){return ve(t)?qt(Ze(t)):Bn(t)};var Gn=function(t){return"function"==typeof t?t:null==t?Rr:"object"==a(t)?y(t)?Hn(t[0],t[1]):Cn(t):Rn(t)};var Vn=function(t,r){var e=-1,n=Jt(t)?Array(t.length):[];return Br(t,(function(t,o,i){n[++e]=r(t,o,i)})),n};var Jn=function(t,r){return(y(t)?d:Vn)(t,Gn(r))},Zn=c((function(t,r){t.exports=function(){var t=1e3,r=6e4,e=36e5,n="millisecond",o="second",i="minute",u="hour",c="day",s="week",f="month",l="quarter",h="year",v="date",p="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var r=["th","st","nd","rd"],e=t%100;return"["+t+(r[(e-20)%10]||r[e]||r[0])+"]"}},g=function(t,r,e){var n=String(t);return!n||n.length>=r?t:""+Array(r+1-n.length).join(e)+t},m={s:g,z:function(t){var r=-t.utcOffset(),e=Math.abs(r),n=Math.floor(e/60),o=e%60;return(r<=0?"+":"-")+g(n,2,"0")+":"+g(o,2,"0")},m:function t(r,e){if(r.date()<e.date())return-t(e,r);var n=12*(e.year()-r.year())+(e.month()-r.month()),o=r.clone().add(n,f),i=e-o<0,a=r.clone().add(n+(i?-1:1),f);return+(-(n+(e-o)/(i?o-a:a-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:f,y:h,w:s,d:c,D:v,h:u,m:i,s:o,ms:n,Q:l}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},j="en",w={};w[j]=b;var _=function(t){return t instanceof S},x=function t(r,e,n){var o;if(!r)return j;if("string"==typeof r){var i=r.toLowerCase();w[i]&&(o=i),e&&(w[i]=e,o=i);var a=r.split("-");if(!o&&a.length>1)return t(a[0])}else{var u=r.name;w[u]=r,o=u}return!n&&o&&(j=o),o||!n&&j},O=function(t,r){if(_(t))return t.clone();var e="object"==a(r)?r:{};return e.date=t,e.args=arguments,new S(e)},$=m;$.l=x,$.i=_,$.w=function(t,r){return O(t,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var S=function(){function a(t){this.$L=x(t.locale,null,!0),this.parse(t)}var b=a.prototype;return b.parse=function(t){this.$d=function(t){var r=t.date,e=t.utc;if(null===r)return new Date(NaN);if($.u(r))return new Date;if(r instanceof Date)return new Date(r);if("string"==typeof r&&!/Z$/i.test(r)){var n=r.match(d);if(n){var o=n[2]-1||0,i=(n[7]||"0").substring(0,3);return e?new Date(Date.UTC(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(r)}(t),this.$x=t.x||{},this.init()},b.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},b.$utils=function(){return $},b.isValid=function(){return!(this.$d.toString()===p)},b.isSame=function(t,r){var e=O(t);return this.startOf(r)<=e&&e<=this.endOf(r)},b.isAfter=function(t,r){return O(t)<this.startOf(r)},b.isBefore=function(t,r){return this.endOf(r)<O(t)},b.$g=function(t,r,e){return $.u(t)?this[r]:this.set(e,t)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(t,r){var e=this,n=!!$.u(r)||r,a=$.p(t),l=function(t,r){var o=$.w(e.$u?Date.UTC(e.$y,r,t):new Date(e.$y,r,t),e);return n?o:o.endOf(c)},p=function(t,r){return $.w(e.toDate()[t].apply(e.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(r)),e)},d=this.$W,y=this.$M,b=this.$D,g="set"+(this.$u?"UTC":"");switch(a){case h:return n?l(1,0):l(31,11);case f:return n?l(1,y):l(0,y+1);case s:var m=this.$locale().weekStart||0,j=(d<m?d+7:d)-m;return l(n?b-j:b+(6-j),y);case c:case v:return p(g+"Hours",0);case u:return p(g+"Minutes",1);case i:return p(g+"Seconds",2);case o:return p(g+"Milliseconds",3);default:return this.clone()}},b.endOf=function(t){return this.startOf(t,!1)},b.$set=function(t,r){var e,a=$.p(t),s="set"+(this.$u?"UTC":""),l=(e={},e[c]=s+"Date",e[v]=s+"Date",e[f]=s+"Month",e[h]=s+"FullYear",e[u]=s+"Hours",e[i]=s+"Minutes",e[o]=s+"Seconds",e[n]=s+"Milliseconds",e)[a],p=a===c?this.$D+(r-this.$W):r;if(a===f||a===h){var d=this.clone().set(v,1);d.$d[l](p),d.init(),this.$d=d.set(v,Math.min(this.$D,d.daysInMonth())).$d}else l&&this.$d[l](p);return this.init(),this},b.set=function(t,r){return this.clone().$set(t,r)},b.get=function(t){return this[$.p(t)]()},b.add=function(n,a){var l,v=this;n=Number(n);var p=$.p(a),d=function(t){var r=O(v);return $.w(r.date(r.date()+Math.round(t*n)),v)};if(p===f)return this.set(f,this.$M+n);if(p===h)return this.set(h,this.$y+n);if(p===c)return d(1);if(p===s)return d(7);var y=(l={},l[i]=r,l[u]=e,l[o]=t,l)[p]||1,b=this.$d.getTime()+n*y;return $.w(b,this)},b.subtract=function(t,r){return this.add(-1*t,r)},b.format=function(t){var r=this,e=this.$locale();if(!this.isValid())return e.invalidDate||p;var n=t||"YYYY-MM-DDTHH:mm:ssZ",o=$.z(this),i=this.$H,a=this.$m,u=this.$M,c=e.weekdays,s=e.months,f=function(t,e,o,i){return t&&(t[e]||t(r,n))||o[e].slice(0,i)},l=function(t){return $.s(i%12||12,t,"0")},h=e.meridiem||function(t,r,e){var n=t<12?"AM":"PM";return e?n.toLowerCase():n},v={YY:String(this.$y).slice(-2),YYYY:this.$y,M:u+1,MM:$.s(u+1,2,"0"),MMM:f(e.monthsShort,u,s,3),MMMM:f(s,u),D:this.$D,DD:$.s(this.$D,2,"0"),d:String(this.$W),dd:f(e.weekdaysMin,this.$W,c,2),ddd:f(e.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(i),HH:$.s(i,2,"0"),h:l(1),hh:l(2),a:h(i,a,!0),A:h(i,a,!1),m:String(a),mm:$.s(a,2,"0"),s:String(this.$s),ss:$.s(this.$s,2,"0"),SSS:$.s(this.$ms,3,"0"),Z:o};return n.replace(y,(function(t,r){return r||v[t]||o.replace(":","")}))},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(n,a,v){var p,d=$.p(a),y=O(n),b=(y.utcOffset()-this.utcOffset())*r,g=this-y,m=$.m(this,y);return m=(p={},p[h]=m/12,p[f]=m,p[l]=m/3,p[s]=(g-b)/6048e5,p[c]=(g-b)/864e5,p[u]=g/e,p[i]=g/r,p[o]=g/t,p)[d]||g,v?m:$.a(m)},b.daysInMonth=function(){return this.endOf(f).$D},b.$locale=function(){return w[this.$L]},b.locale=function(t,r){if(!t)return this.$L;var e=this.clone(),n=x(t,r,!0);return n&&(e.$L=n),e},b.clone=function(){return $.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},a}(),k=S.prototype;return O.prototype=k,[["$ms",n],["$s",o],["$m",i],["$H",u],["$W",c],["$M",f],["$y",h],["$D",v]].forEach((function(t){k[t[1]]=function(r){return this.$g(r,t[0],t[1])}})),O.extend=function(t,r){return t.$i||(t(r,S,O),t.$i=!0),O},O.locale=x,O.isDayjs=_,O.unix=function(t){return O(1e3*t)},O.en=w[j],O.Ls=w,O.p={},O}()}));function qn(){return Zn().format("YYYY-MM-DDTHH:mm:ss.SSSZ")}var Qn=null,Kn=null;function Xn(t,r,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"save";if(!te(Qn))throw new Error("invalid ds");var o=Qn[t].keys,i=!1;Zr(e)||(i=!0,e=[e]);var a=qn();return n.indexOf("insert")>=0&&(o.indexOf("userId")>=0&&Vr(e,(function(t,n){e[n].userId=r})),o.indexOf("timeCreate")>=0&&Vr(e,(function(t,r){e[r].timeCreate=a}))),(n.indexOf("insert")>=0||n.indexOf("save")>=0)&&(o.indexOf("userIdUpdate")>=0&&Vr(e,(function(t,n){e[n].userIdUpdate=r})),o.indexOf("timeUpdate")>=0&&Vr(e,(function(t,r){e[r].timeUpdate=a}))),e=i?e[0]:e}function to(t,r,e,n){return ro.apply(this,arguments)}function ro(){return(ro=i(f.mark((function t(r,e,n,o){var i,a,u,c,s,l,h;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=null,te(Kn)){t.next=3;break}return t.abrupt("return",Promise.reject("無有效woItems"));case 3:if(null!==(u=Qe(Kn,e,null))){t.next=6;break}return t.abrupt("return",Promise.reject("ORM找不到表名稱: ".concat(e)));case 6:if("select"!==n){t.next=14;break}return t.next=9,u.select(o).catch((function(t){console.log("".concat(e,".select catch"),t),i="取得資料失敗"}));case 9:if(a=t.sent,!ne(i)){t.next=12;break}return t.abrupt("return",Promise.reject(i));case 12:t.next=100;break;case 14:if("insert"!==n&&"save"!==n){t.next=39;break}t.prev=15,o=Xn(e,r,o,n),t.next=24;break;case 19:return t.prev=19,t.t0=t.catch(15),console.log("adjustData catch",t.t0.toString()),i="調整資料失敗",t.abrupt("return",Promise.reject(i));case 24:if("insert"!==n){t.next=30;break}return t.next=27,u.insert(o).catch((function(t){console.log("".concat(e,".save catch"),t),i="新增資料失敗"}));case 27:a=t.sent,t.next=34;break;case 30:if("save"!==n){t.next=34;break}return t.next=33,u.save(o,{atomic:!0}).catch((function(t){console.log("".concat(e,".save catch"),t),i="儲存資料失敗"}));case 33:a=t.sent;case 34:if(!ne(i)){t.next=36;break}return t.abrupt("return",Promise.reject(i));case 36:a=Zr(o)?Jn(o,(function(t){return{id:t.id}})):{id:o.id},t.next=100;break;case 39:if("del"!==n){t.next=45;break}return t.next=42,u.del(o).catch((function(t){console.log("".concat(e,".del catch"),t),i="刪除資料失敗"}));case 42:a=t.sent,t.next=100;break;case 45:if("delAll"!==n){t.next=51;break}return t.next=48,u.delAll(o).catch((function(t){console.log("".concat(e,".delAll catch"),t),i="刪除資料失敗"}));case 48:a=t.sent,t.next=100;break;case 51:if("mix"!==n){t.next=99;break}if(te(o)){t.next=54;break}return t.abrupt("return",Promise.reject("mix僅支援輸入ltdtdiff結果物件"));case 54:if(a=[],s=Qe(o,"add",[]),!(hr(s)>0)){t.next=72;break}t.prev=57,s=Xn(e,r,s,"insert+save"),t.next=66;break;case 61:return t.prev=61,t.t1=t.catch(57),console.log("adjustData catch",t.t1.toString()),i="調整資料失敗",t.abrupt("return",Promise.reject(i));case 66:return t.next=68,u.insert(s).catch((function(t){console.log("".concat(e,".save catch"),t),i="新增資料失敗"}));case 68:if(!ne(i)){t.next=70;break}return t.abrupt("return",Promise.reject(i));case 70:c=Jn(s,(function(t){return{id:t.id}})),a=[].concat(fe(a),fe(c));case 72:if(l=Qe(o,"del",[]),!(hr(l)>0)){t.next=80;break}return t.next=76,u.del(l).catch((function(t){console.log("".concat(e,".save catch"),t),i="刪除資料失敗"}));case 76:if(!ne(i)){t.next=78;break}return t.abrupt("return",Promise.reject(i));case 78:c=Jn(l,(function(t){return{id:t.id}})),a=[].concat(fe(a),fe(c));case 80:if(h=Qe(o,"diff",[]),!(hr(h)>0)){t.next=97;break}t.prev=82,h=Xn(e,r,h),t.next=91;break;case 86:return t.prev=86,t.t2=t.catch(82),console.log("adjustData catch",t.t2.toString()),i="調整資料失敗",t.abrupt("return",Promise.reject(i));case 91:return t.next=93,u.save(h).catch((function(t){console.log("".concat(e,".save catch"),t),i="變更資料失敗"}));case 93:if(!ne(i)){t.next=95;break}return t.abrupt("return",Promise.reject(i));case 95:c=Jn(h,(function(t){return{id:t.id}})),a=[].concat(fe(a),fe(c));case 97:t.next=100;break;case 99:i="invalid mode: ".concat(n);case 100:if(!ne(i)){t.next=102;break}return t.abrupt("return",Promise.reject(i));case 102:return t.abrupt("return",a);case 103:case"end":return t.stop()}}),t,null,[[15,19],[57,61],[82,86]])})))).apply(this,arguments)}function eo(t,r){return Qn=t,Kn=r,to}var no=function(t,r){var e=[];return Br(t,(function(t,n,o){r(t,n,o)&&e.push(t)})),e};var oo=function(t,r){return(y(t)?wn:no)(t,Gn(r))};function io(t){var r=!1;return ne(t)?r=!isNaN(Number(t)):function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)&&(r=!0),r}function ao(t,r){return!!qr(t)&&(!(!ne(r)&&!io(r))&&r in t)}function uo(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Zr(t)){var e=Jr();return e.reject("pms is not an array"),e}return t.reduce((function(t,r){return t.then(r)}),Promise.resolve(r))}var co=[],so=[],fo=[],lo=null,ho=null,vo=!0,po=!0;function yo(t){setTimeout((function(){co.push(t)}),1)}function bo(t){setTimeout((function(){so.push(t)}),1)}function go(t){setTimeout((function(){fo.push(t)}),1)}function mo(t,r,e,n){return jo.apply(this,arguments)}function jo(){return(jo=i(f.mark((function t(r,e,n,o){var i,a,u,c,s,l;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Qr(lo)){t.next=2;break}return t.abrupt("return",Promise.reject("invalid mapOrm"));case 2:if(ne(r)){t.next=5;break}return console.log("找不到使用者主鍵: (".concat(r,")")),t.abrupt("return",Promise.reject("找不到使用者主鍵"));case 5:if(i="n",!vo){t.next=22;break}if(Qr(ho)){t.next=9;break}return t.abrupt("return",Promise.reject("invalid getUserById"));case 9:return t.next=11,ho(r);case 11:if(a=t.sent){t.next=15;break}return console.log("找不到使用者資訊: (".concat(r,")")),t.abrupt("return",Promise.reject("找不到使用者資訊"));case 15:if("y"!==(i=Qe(a,"isAdmin"))&&"n"!==i&&(i="n"),"y"!==(u=Qe(a,"isActive"))&&"n"!==u&&(u="n"),"y"===u){t.next=22;break}return console.log("使用者被停權或無有效使用者資訊: (".concat(r,")")),t.abrupt("return",Promise.reject("使用者被停權或無有效使用者資訊"));case 22:return t.next=24,Kr(co,(function(t){return t({woName:e,userId:r,isAdmin:i,mode:n,input:o})}));case 24:if(!(hr(so)>0)){t.next=30;break}return c={woName:e,userId:r,isAdmin:i,mode:n,input:o},t.next=28,uo(so,c);case 28:s=t.sent,o=s.input;case 30:return t.next=32,lo(r,e,n,o);case 32:if(l=t.sent,po&&"n"===i&&"select"===n&&Zr(l)&&(l=oo(l,(function(t){return!ao(t,"isActive")||!("n"===t.isActive)}))),!(hr(fo)>0)){t.next=38;break}return t.next=37,uo(fo,{woName:e,userId:r,isAdmin:i,mode:n,input:o,output:l});case 37:l=t.sent;case 38:return t.abrupt("return",l);case 39:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function wo(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Qr(t)?(lo=t,ee(vo=Qe(r,"bCheckUser"))||(vo=!0),ho=Qe(r,"getUserById"),ee(po=Qe(r,"bExcludeWhenNotAdmin"))||(po=!0),{addFunCheck:yo,addFunPreProcessing:bo,addFunPostProcessing:go,procOrm:mo}):Promise.reject("invalid mapOrm")}function _o(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function xo(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?_o(Object(e),!0).forEach((function(r){n(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):_o(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}return function(t,r,e,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=ce(t,r,e,n),a=eo(t,i),u=wo(a,o);return xo(xo({},ue),{},{woItems:i},u)}}));
//# sourceMappingURL=w-serv-orm.umd.js.map
